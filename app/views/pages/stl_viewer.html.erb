<% title "STL Viewer" %>

<p>
  This is an STL to three.js model viewer done totally in javascript.
</p>

<div id="canvas_container"></div>
Note: pinch to zoom on iOS or scroll wheel (only in Chrome at the moment...)

<p>
  <%= label_tag "stl_data", "ASCII STL Data" %>
  <%= text_area_tag "stl_data", "solid
  solid OpenSCAD_Model
    facet normal -1.000000 -0.000000 -0.000000
      outer loop
        vertex -5.000000 -5.000000 0.000000
        vertex -5.000000 -5.000000 10.000000
        vertex -5.000000 5.000000 0.000000
      endloop
    endfacet
    facet normal -1.000000 0.000000 0.000000
      outer loop
        vertex -5.000000 5.000000 0.000000
        vertex -5.000000 -5.000000 10.000000
        vertex -5.000000 5.000000 10.000000
      endloop
    endfacet
    facet normal 0.000000 -1.000000 0.000000
      outer loop
        vertex -5.000000 -5.000000 10.000000
        vertex -5.000000 -5.000000 0.000000
        vertex 5.000000 -5.000000 0.000000
      endloop
    endfacet
    facet normal 0.000000 -1.000000 0.000000
      outer loop
        vertex 5.000000 -5.000000 10.000000
        vertex -5.000000 -5.000000 10.000000
        vertex 5.000000 -5.000000 0.000000
      endloop
    endfacet
    facet normal 0.000000 -0.000000 -1.000000
      outer loop
        vertex 1.246980 1.563663 0.000000
        vertex -5.000000 5.000000 0.000000
        vertex 5.000000 5.000000 0.000000
      endloop
    endfacet
    facet normal 0.000000 -0.000000 -1.000000
      outer loop
        vertex -5.000000 -5.000000 0.000000
        vertex -5.000000 5.000000 0.000000
        vertex -1.801938 0.867767 0.000000
      endloop
    endfacet
    facet normal 0.000000 0.000000 -1.000000
      outer loop
        vertex -5.000000 -5.000000 0.000000
        vertex -1.801938 0.867767 0.000000
        vertex -1.801938 -0.867767 0.000000
      endloop
    endfacet
    facet normal 0.000000 0.000000 -1.000000
      outer loop
        vertex -5.000000 -5.000000 0.000000
        vertex -1.801938 -0.867767 0.000000
        vertex -0.445042 -1.949856 0.000000
      endloop
    endfacet
    facet normal -0.000000 0.000000 -1.000000
      outer loop
        vertex -5.000000 -5.000000 0.000000
        vertex -0.445042 -1.949856 0.000000
        vertex 5.000000 -5.000000 0.000000
      endloop
    endfacet
    facet normal 0.000000 0.000000 -1.000000
      outer loop
        vertex 1.246980 -1.563663 0.000000
        vertex 5.000000 -5.000000 0.000000
        vertex -0.445042 -1.949856 0.000000
      endloop
    endfacet
    facet normal 0.000000 0.000000 -1.000000
      outer loop
        vertex 2.000000 0.000000 0.000000
        vertex 5.000000 -5.000000 0.000000
        vertex 1.246980 -1.563663 0.000000
      endloop
    endfacet
    facet normal 0.000000 0.000000 -1.000000
      outer loop
        vertex 5.000000 -5.000000 0.000000
        vertex 2.000000 0.000000 0.000000
        vertex 5.000000 5.000000 0.000000
      endloop
    endfacet
    facet normal -0.000000 -0.000000 -1.000000
      outer loop
        vertex -0.445042 1.949856 0.000000
        vertex -5.000000 5.000000 0.000000
        vertex 1.246980 1.563663 0.000000
      endloop
    endfacet
    facet normal 0.000000 -0.000000 -1.000000
      outer loop
        vertex 2.000000 0.000000 0.000000
        vertex 1.246980 1.563663 0.000000
        vertex 5.000000 5.000000 0.000000
      endloop
    endfacet
    facet normal 0.000000 -0.000000 -1.000000
      outer loop
        vertex -1.801938 0.867767 0.000000
        vertex -5.000000 5.000000 0.000000
        vertex -0.445042 1.949856 0.000000
      endloop
    endfacet
    facet normal 0.000000 1.000000 0.000000
      outer loop
        vertex -5.000000 5.000000 0.000000
        vertex -5.000000 5.000000 10.000000
        vertex 5.000000 5.000000 0.000000
      endloop
    endfacet
    facet normal 0.000000 1.000000 0.000000
      outer loop
        vertex 5.000000 5.000000 0.000000
        vertex -5.000000 5.000000 10.000000
        vertex 5.000000 5.000000 10.000000
      endloop
    endfacet
    facet normal 0.000000 -0.000000 1.000000
      outer loop
        vertex -0.445042 -1.949856 10.000000
        vertex -5.000000 -5.000000 10.000000
        vertex 5.000000 -5.000000 10.000000
      endloop
    endfacet
    facet normal 0.000000 -0.000000 1.000000
      outer loop
        vertex -5.000000 5.000000 10.000000
        vertex -5.000000 -5.000000 10.000000
        vertex -1.801938 -0.867767 10.000000
      endloop
    endfacet
    facet normal 0.000000 0.000000 1.000000
      outer loop
        vertex -5.000000 5.000000 10.000000
        vertex -1.801938 -0.867767 10.000000
        vertex -1.801938 0.867767 10.000000
      endloop
    endfacet
    facet normal 0.000000 0.000000 1.000000
      outer loop
        vertex 5.000000 5.000000 10.000000
        vertex -5.000000 5.000000 10.000000
        vertex -0.445042 1.949856 10.000000
      endloop
    endfacet
    facet normal 0.000000 0.000000 1.000000
      outer loop
        vertex 5.000000 5.000000 10.000000
        vertex 1.246980 1.563663 10.000000
        vertex 5.000000 -5.000000 10.000000
      endloop
    endfacet
    facet normal 0.000000 0.000000 1.000000
      outer loop
        vertex 5.000000 5.000000 10.000000
        vertex -0.445042 1.949856 10.000000
        vertex 1.246980 1.563663 10.000000
      endloop
    endfacet
    facet normal 0.000000 0.000000 1.000000
      outer loop
        vertex 1.246980 1.563663 10.000000
        vertex 2.000000 0.000000 10.000000
        vertex 5.000000 -5.000000 10.000000
      endloop
    endfacet
    facet normal 0.000000 -0.000000 1.000000
      outer loop
        vertex 2.000000 0.000000 10.000000
        vertex 1.246980 -1.563663 10.000000
        vertex 5.000000 -5.000000 10.000000
      endloop
    endfacet
    facet normal 0.000000 -0.000000 1.000000
      outer loop
        vertex 1.246980 -1.563663 10.000000
        vertex -0.445042 -1.949856 10.000000
        vertex 5.000000 -5.000000 10.000000
      endloop
    endfacet
    facet normal 0.000000 -0.000000 1.000000
      outer loop
        vertex -1.801938 -0.867767 10.000000
        vertex -5.000000 -5.000000 10.000000
        vertex -0.445042 -1.949856 10.000000
      endloop
    endfacet
    facet normal 0.000000 0.000000 1.000000
      outer loop
        vertex -1.801938 0.867767 10.000000
        vertex -0.445042 1.949856 10.000000
        vertex -5.000000 5.000000 10.000000
      endloop
    endfacet
    facet normal 1.000000 0.000000 -0.000000
      outer loop
        vertex 5.000000 -5.000000 10.000000
        vertex 5.000000 -5.000000 0.000000
        vertex 5.000000 5.000000 0.000000
      endloop
    endfacet
    facet normal 1.000000 0.000000 0.000000
      outer loop
        vertex 5.000000 5.000000 10.000000
        vertex 5.000000 -5.000000 10.000000
        vertex 5.000000 5.000000 0.000000
      endloop
    endfacet
    facet normal 0.623490 -0.781831 0.000000
      outer loop
        vertex -0.445042 1.949856 0.000000
        vertex -0.445042 1.949856 10.000000
        vertex -1.801938 0.867767 10.000000
      endloop
    endfacet
    facet normal 0.623490 -0.781831 0.000000
      outer loop
        vertex -1.801938 0.867767 0.000000
        vertex -0.445042 1.949856 0.000000
        vertex -1.801938 0.867767 10.000000
      endloop
    endfacet
    facet normal 1.000000 0.000000 0.000000
      outer loop
        vertex -1.801938 0.867767 0.000000
        vertex -1.801938 0.867767 10.000000
        vertex -1.801938 -0.867767 10.000000
      endloop
    endfacet
    facet normal 1.000000 0.000000 0.000000
      outer loop
        vertex -1.801938 -0.867767 0.000000
        vertex -1.801938 0.867767 0.000000
        vertex -1.801938 -0.867767 10.000000
      endloop
    endfacet
    facet normal -0.222521 -0.974928 -0.000000
      outer loop
        vertex 1.246980 1.563663 0.000000
        vertex 1.246980 1.563663 10.000000
        vertex -0.445042 1.949856 10.000000
      endloop
    endfacet
    facet normal -0.222521 -0.974928 -0.000000
      outer loop
        vertex -0.445042 1.949856 0.000000
        vertex 1.246980 1.563663 0.000000
        vertex -0.445042 1.949856 10.000000
      endloop
    endfacet
    facet normal -0.900969 -0.433884 0.000000
      outer loop
        vertex 2.000000 0.000000 10.000000
        vertex 1.246980 1.563663 10.000000
        vertex 2.000000 0.000000 0.000000
      endloop
    endfacet
    facet normal -0.900969 -0.433884 0.000000
      outer loop
        vertex 2.000000 0.000000 0.000000
        vertex 1.246980 1.563663 10.000000
        vertex 1.246980 1.563663 0.000000
      endloop
    endfacet
    facet normal -0.900969 0.433884 0.000000
      outer loop
        vertex 2.000000 0.000000 10.000000
        vertex 2.000000 0.000000 0.000000
        vertex 1.246980 -1.563663 10.000000
      endloop
    endfacet
    facet normal -0.900969 0.433884 0.000000
      outer loop
        vertex 1.246980 -1.563663 10.000000
        vertex 2.000000 0.000000 0.000000
        vertex 1.246980 -1.563663 0.000000
      endloop
    endfacet
    facet normal -0.222521 0.974928 0.000000
      outer loop
        vertex 1.246980 -1.563663 10.000000
        vertex 1.246980 -1.563663 0.000000
        vertex -0.445042 -1.949856 10.000000
      endloop
    endfacet
    facet normal -0.222521 0.974928 0.000000
      outer loop
        vertex -0.445042 -1.949856 10.000000
        vertex 1.246980 -1.563663 0.000000
        vertex -0.445042 -1.949856 0.000000
      endloop
    endfacet
    facet normal 0.623490 0.781831 -0.000000
      outer loop
        vertex -0.445042 -1.949856 10.000000
        vertex -0.445042 -1.949856 0.000000
        vertex -1.801938 -0.867767 10.000000
      endloop
    endfacet
    facet normal 0.623490 0.781831 -0.000000
      outer loop
        vertex -1.801938 -0.867767 10.000000
        vertex -0.445042 -1.949856 0.000000
        vertex -1.801938 -0.867767 0.000000
      endloop
    endfacet
  endsolid OpenSCAD_Model
  ", :style => "width:100%;height:300px" %><br/>

  <%= button_to_function "Render", "load_stl_mesh(document.getElementById('stl_data').value);" %><br/>
</p>

<pre><p id="debug"></p></pre>
